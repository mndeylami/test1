"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Condition_1 = require("../Condition");
class TitleCondition extends Condition_1.Condition {
    constructor(desc, expectedTitle, partial = false) {
        super(desc);
        this.expectedTitle = expectedTitle;
        this.partial = partial;
    }
    toString() {
        return `page title to equal '${this.expectedTitle}'`;
    }
    async waitFor(frame) {
        await frame.waitForFunction((title, partial) => {
            if (typeof title === 'string') {
                if (title.startsWith('/') && title.endsWith('/')) {
                    // RegExp
                    let exp = new RegExp(title.slice(1, title.length - 1));
                    return exp.test(document.title);
                }
                else if (partial) {
                    return document.title.indexOf(title) > -1;
                }
                else {
                    return document.title.trim() === title.trim();
                }
            }
        }, { polling: 'mutation', timeout: 30e3 }, this.expectedTitle, this.partial === true);
        return true;
    }
}
exports.TitleCondition = TitleCondition;
