"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Condition_1 = require("../Condition");
class URLCondition extends Condition_1.Condition {
    constructor(desc, url, partial = false) {
        super(desc);
        this.url = url;
        this.partial = partial;
    }
    toString() {
        return `waiting for URL to equal "${this.url}"`;
    }
    async waitFor(frame) {
        await frame.waitForFunction((url, partial) => {
            if (typeof url === 'string') {
                if (url.startsWith('/') && url.endsWith('/')) {
                    // RegExp
                    let exp = new RegExp(url.slice(1, url.length - 1));
                    return exp.test(window.location.href);
                }
                else if (partial) {
                    return window.location.href.toLowerCase().indexOf(url.toLowerCase()) > -1;
                }
                else {
                    return window.location.href.trim().toLowerCase() === url.trim().toLowerCase();
                }
            }
        }, { polling: 'raf', timeout: 30e3 }, this.url, this.partial === true);
        return true;
    }
}
exports.URLCondition = URLCondition;
