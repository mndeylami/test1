"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class AsyncQueue {
    constructor(chain = Promise.resolve(null)) {
        this.chain = chain;
    }
    add(task) {
        let result;
        if (task.then && task.catch) {
            result = this.chain.then(() => task);
        }
        else {
            result = this.chain.then(task);
        }
        this.chain = result.catch((err) => {
            console.error(`[AsyncQueue] Callback chain error: ${err.message}`, err.stack);
        });
        return result;
    }
}
exports.AsyncQueue = AsyncQueue;
