"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const kk = (f) => { };
// adapted from https://stackoverflow.com/a/37642079
class CancellationToken {
    constructor(defineUserCancels = kk) {
        this.isCancellationRequested = false;
        // actions to execute when cancelled
        this.onCancelled = [];
        this.onCancelled.push(() => (this.isCancellationRequested = true));
        // expose a promise to the outside
        this.promise = new Promise(resolve => this.onCancelled.push(resolve));
        // let the user add handlers
        defineUserCancels((f) => {
            this.onCancelled.push(f);
            return;
        });
    }
    static neverCancelToken() {
        return new CancellationToken();
    }
    cancel() {
        this.onCancelled.forEach(x => x());
    }
}
exports.CancellationToken = CancellationToken;
